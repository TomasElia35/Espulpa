<section class="detalle-section" *ngIf="loading">
  <div class="container text-center py-5">
    <div class="spinner-border text-danger" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>
</section>

<section class="detalle-section" *ngIf="!loading && libro">
  <div class="container">

    <div class="row mb-4">
      <div class="col-12">
        <a routerLink="/catalogo" class="text-muted text-decoration-none small text-uppercase">
          <i class="bi bi-arrow-left me-1"></i> Volver al Catálogo
        </a>
      </div>
    </div>

    <div class="row align-items-start">

      <div class="col-md-5 col-lg-4 mb-5 mb-md-0 text-center">
        <div class="portada-wrapper">
          <img [src]="libro.imagenes && libro.imagenes.length > 0 ? libro.imagenes[0].urlImagen : ''"
            [alt]="libro.titulo" class="img-fluid portada-libro">
        </div>
      </div>

      <div class="col-md-7 col-lg-8 ps-md-5">

        <span class="badge bg-danger rounded-0 mb-3 px-3 fw-light tracking-wide"
          *ngIf="libro.categorias && libro.categorias.length > 0">
          {{ libro.categorias[0].nombre }}
        </span>

        <h1 class="display-4 title-serif mb-2">{{ libro.titulo }}</h1>

        <p class="h5 text-muted fst-italic mb-4 author-name">
          de {{ libro.autor.nombre }}
        </p>

        <div class="price-box mb-4">
          <h3 class="text-danger fw-bold" *ngIf="libro.precioObj">
            ${{ libro.precioObj.precioFinal }}
          </h3>
          <h3 class="text-muted" *ngIf="!libro.precioObj">Consultar</h3>
        </div>

        <div class="description-box mb-5">
          <h6 class="text-uppercase fw-bold small text-dark mb-3">Sinopsis</h6>

          <p class="lead text-secondary synopsis-text">
            {{ libro.detalle?.descripcion || 'Sin descripción disponible para este título.' }}
          </p>
        </div>

        <div class="d-flex gap-3">
          <button class="btn btn-dark btn-lg rounded-0 px-5">
            Comprar Ahora
          </button>
          <button class="btn btn-outline-dark btn-lg rounded-0 px-3">
            <i class="bi bi-share"></i>
          </button>
        </div>

        <div class="mt-5 pt-4 border-top">
          <div class="row text-muted small">

            <div class="col-6 col-md-4 mb-3">
              <strong>Publicación:</strong><br>
              {{ libro.fechaPublicacion | date:'yyyy' }}
            </div>

            <div class="col-6 col-md-4 mb-3" *ngIf="libro.stock">
              <strong>Disponibilidad:</strong><br>

              <span [class.text-success]="libro.stock.stockActual > 0"
                [class.text-danger]="libro.stock.stockActual === 0">

                {{ libro.stock.stockActual > 0 ? 'En Stock' : 'Agotado' }}

              </span>
            </div>

          </div>
        </div>

      </div>

    </div>
  </div>
</section>